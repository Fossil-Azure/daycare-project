<h2 mat-dialog-title>Salary Breakdown</h2>
<mat-dialog-content class="ctc-layout" id="ctc-layout">
  <section class="info-section">
    <div class="info-row">
      <span class="label">Name:</span>
      <span class="value">{{ data.name }}</span>
    </div>
    <div class="info-row">
      <span class="label">Qualification:</span>
      <span class="value">{{ data.qualification }}</span>
    </div>
    <div class="info-row">
      <span class="label">Designation:</span>
      <span class="value">{{ data.designation }}</span>
    </div>
    <div class="info-row">
      <span class="label">Grade:</span>
      <span class="value">{{ data.grade }}</span>
    </div>
    <div class="info-row">
      <span class="label">Location:</span>
      <span class="value">{{ data.location }}</span>
    </div>
    <div class="info-row">
      <span class="label">Total Years of Experience:</span>
      <span class="value">{{ data.experience }}</span>
    </div>
    <div class="info-row">
      <span class="label">CTC:</span>
      <span class="value">₹{{ data.totalCtc }}</span>
    </div>
  </section>

  <table class="ctc-table">
    <thead>
      <tr>
        <th>Component</th>
        <th>Per Month</th>
        <th>Per Annum</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let row of breakdownRows">
        <td>{{ row.label }}</td>
        <td>₹{{ row.monthly | number }}</td>
        <td></td>
      </tr>
      <tr class="subtotal">
        <td><strong>Sub Total</strong></td>
        <td>₹{{ data.monthlyTotal | number }}</td>
        <td>₹{{ data.annualTotal | number }}</td>
      </tr>
      <tr>
        <td>Provident Fund - Company Contribution</td>
        <td></td>
        <td>₹{{ data.pf | number }}</td>
      </tr>
      <tr>
        <td>Gratuity</td>
        <td></td>
        <td>₹{{ data.gratuity | number }}</td>
      </tr>
      <tr>
        <td>Festival Allowance</td>
        <td></td>
        <td>₹{{ data.festive | number }}</td>
      </tr>
      <tr class="subtotal">
        <td><strong>Sub Total CTC</strong></td>
        <td></td>
        <td>₹{{ data.subTotal | number }}</td>
      </tr>
      <tr>
        <td>Sales Incentive &#64; 100% Achievement</td>
        <td></td>
        <td>₹{{ data.incentive | number }}</td>
      </tr>
      <tr class="total-row">
        <td><strong>Total CTC</strong></td>
        <td></td>
        <td>
          <strong>₹{{ data.totalCtc | number }}</strong>
        </td>
      </tr>
    </tbody>
  </table>
</mat-dialog-content>

<mat-dialog-actions align="center">
  <div class="action-buttons">
    <button
      mat-raised-button
      class="logic-button"
      (click)="openCalculationDialog()"
    >
      Calculation Logic
    </button>
    <!-- <button mat-raised-button class="download-button" (click)="downloadAsXML()">Download XML</button> -->
    <button
      mat-raised-button
      class="download-button"
      (click)="downloadCTCJPEG()"
    >
      Download JPEG
    </button>
    <button
      mat-raised-button
      class="download-button-pdf"
      (click)="generatePDF()"
    >
      Download PDF
    </button>
    <button mat-raised-button class="close-button" mat-dialog-close>
      Close
    </button>
  </div>
</mat-dialog-actions>

<!-- This one is only for export, not shown in popup -->
<div id="ctc-export" style="display:none; text-align:center; padding:20px; background:#fff;">

  <!-- Header Section -->
  <div style="margin-bottom: 20px;">
    <img src="assets/fossil_logo.png" alt="Fossil Logo" style="width:120px; height:auto; margin-bottom:10px;" />
    <h2 style="margin:0; font-family: Arial, sans-serif; font-weight:bold; color:#2c3e50;">
      FOSSIL SALARY STRUCTURE
    </h2>
  </div>

  <!-- Employee Info -->
  <section class="info-section" style="text-align:left; margin-top:20px;">
    <div class="info-row"><span class="label">Name:</span> <span class="value">{{ data.name }}</span></div>
    <div class="info-row"><span class="label">Qualification:</span> <span class="value">{{ data.qualification }}</span></div>
    <div class="info-row"><span class="label">Designation:</span> <span class="value">{{ data.designation }}</span></div>
    <div class="info-row"><span class="label">Grade:</span> <span class="value">{{ data.grade }}</span></div>
    <div class="info-row"><span class="label">Location:</span> <span class="value">{{ data.location }}</span></div>
    <div class="info-row"><span class="label">Total Years of Experience:</span> <span class="value">{{ data.experience }}</span></div>
    <div class="info-row"><span class="label">CTC:</span> <span class="value">₹{{ data.totalCtc }}</span></div>
  </section>

  <!-- Salary Table -->
  <table class="ctc-table" style="width:100%; border-collapse:collapse; margin-top:20px;">
    <thead>
      <tr style="background:#16a085; color:#fff; text-align:center;">
        <th style="padding:8px;">Component</th>
        <th style="padding:8px;">Per Month</th>
        <th style="padding:8px;">Per Annum</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let row of breakdownRows">
        <td style="padding:6px; border:1px solid #ccc;">{{ row.label }}</td>
        <td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ row.monthly | number }}</td>
        <td style="padding:6px; border:1px solid #ccc; text-align:right;"></td>
      </tr>
      <tr class="subtotal" style="font-weight:bold;">
        <td style="padding:6px; border:1px solid #ccc;">Sub Total</td>
        <td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.monthlyTotal | number }}</td>
        <td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.annualTotal | number }}</td>
      </tr>
      <tr><td style="padding:6px; border:1px solid #ccc;">Provident Fund - Company Contribution</td><td></td><td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.pf | number }}</td></tr>
      <tr><td style="padding:6px; border:1px solid #ccc;">Gratuity</td><td></td><td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.gratuity | number }}</td></tr>
      <tr><td style="padding:6px; border:1px solid #ccc;">Festival Allowance</td><td></td><td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.festive | number }}</td></tr>
      <tr class="subtotal" style="font-weight:bold;">
        <td style="padding:6px; border:1px solid #ccc;">Sub Total CTC</td>
        <td></td>
        <td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.subTotal | number }}</td>
      </tr>
      <tr><td style="padding:6px; border:1px solid #ccc;">Sales Incentive &#64; 100% Achievement</td><td></td><td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.incentive | number }}</td></tr>
      <tr class="total-row" style="background:#16a085; color:#fff; font-weight:bold;">
        <td style="padding:6px; border:1px solid #ccc;">Total CTC</td>
        <td style="border:1px solid #ccc;"></td>
        <td style="padding:6px; border:1px solid #ccc; text-align:right;">₹{{ data.totalCtc | number }}</td>
      </tr>
    </tbody>
  </table>
</div>